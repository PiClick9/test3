"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9688],{19688:(e,t,n)=>{n.r(t),n.d(t,{Component:()=>h,Permutive:()=>y});var r=n(6029),i=n(18272),a=n(46581),o=n(47947),s=n(6772),c=n.n(s),l=n(55729),u=n(10811);let d={story:"article",gallery:"article","video-story":"article",recipe:"article",tags:"tags",homepage:"homepage",cover:"cover",other:"other"},g=e=>{let t=(0,u.U)(e),n=d[t.page.documentType]||"other",r={classifications_watson:{concepts:"$alchemy_concepts",emotion:"$alchemy_document_emotion",entities:"$alchemy_entities",keywords:"$alchemy_keywords",sentiment:"$alchemy_document_sentiment",taxonomy_labels:"$alchemy_taxonomy_labels",taxonomy:"$alchemy_taxonomy"},documentType:t.page.documentType||"",publication:t.page.publication||"",user:{age:t.user.ageUser||0,gender:t.user.genderUser||"",type:t.user.userType||""},content:{categories:t.page.section?[t.page.section]:[],subsection:t.page.subsection?[t.page.subsection]:[]}};if("article"===n){var i,a;(null==e||null==(a=e.articleStats)||null==(i=a.aiContentEnrichment)?void 0:i.permutive)&&(r.ai_content_enrichments=e.articleStats.aiContentEnrichment.permutive),r.article={authors:t.article.author||[],classification:t.article.contentClassification?[t.article.contentClassification]:[],description:t.article.descriptionURL||"",extension:t.article.articleLength||0,id:String(t.article.articleID||""),keywords:t.article.keywords||[],modifiedAt:new Date(e.articleStats.originalDateModified).toISOString()||"",premium:t.article.isPremium||!1,publishedAt:new Date(e.articleStats.originalDatePublication).toISOString()||"",tags:"string"==typeof t.article.tags?[t.article.tags]:t.article.tags||[],title:t.article.articleTitle||"",headline:t.article.articleHeadline||"",subtitle:t.article.articleSubtitle||"",numberParagraphs:t.article.numberParagraphs||1,clientName:t.article.clientName||"",articleType:t.article.articleType||"article",contentPurpose:t.article.contentPurpose||"",commercialPurpose:t.article.commercialPurpose||[],video:{valid:t.article.hasVideo||!1,title:t.article.videoTitle||""},numberAds:t.article.numberAds||0,contentAccess:t.article.contentAccess||"",numberImages:t.article.numberImages||0,numberLinks:t.article.internalLinks+t.article.externalLinks||0,isOneColumn:t.article.isOneColumn||!1,density:parseFloat((t.article.articleLength/t.article.numberParagraphs||0).toFixed(2))}}return r};var m=n(54540),p=n(16687),w=n(72011),v=n(29143);let f=(0,l.lazy)(()=>n.e(2965).then(n.bind(n,12965)).then(e=>{let{default:t}=e;return{default:t}})),h=e=>{let{pageProps:t}=e,{isDataReady:n,userManageData:o}=(0,m.A)(),s=(0,l.useMemo)(()=>g(t),[t]),{consent:u,token:d}=(0,i.A)({vendorId:p.EX}),[w,f]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{u&&n&&f(!0)},[u,n]),(0,l.useEffect)(()=>(w&&a.P.on("survey",e=>{window.permutive.track("SurveyResponse",e)}),()=>{a.P.off("survey",()=>{})}),[w]),(0,l.useEffect)(()=>{if(w&&n&&1){let e={type:o.userType};o.genderUser&&(e.gender=o.genderUser),o.ageUser&&(e.age=Number(o.ageUser)),window.permutive.track("User",e)}},[n,w]),!u||!n)return null;let h=[];if((null==o?void 0:o.cid)&&h.push({id:o.cid,tag:"ev_sessionId"}),(null==o?void 0:o.guid)&&h.push({id:o.guid,tag:"ev_guid"}),(null==o?void 0:o.email_sha256)&&h.push({id:o.email_sha256,tag:"email_sha256",priority:2}),!w&&Array.isArray(window.dataLayer)){let e="5252a985-8243-4bca-8fe2-13b5d3906efd",n="1c46eda6-f29a-461b-b7fc-52d6e3dad45c";(t.serverContext.urlPath.startsWith("/mexico")||t.serverContext.urlPath.startsWith("/us-es"))&&(e=v.env.NEXT_PUBLIC_PERMUTIVE_API_KEY_ES,n=v.env.NEXT_PUBLIC_PERMUTIVE_PROJECT_ID_ES);let i="https://6da7b56a-3097-4a8c-baaa-4a543536193b.edge.permutive.app/".concat(n,"-web.js"),a=!(t.serverContext.urlPath.startsWith("/mexico")||t.serverContext.urlPath.startsWith("/us-es")||t.serverContext.urlPath.startsWith("/us"));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c(),{id:"permutive-script",dangerouslySetInnerHTML:{__html:'!function(e,o,n,i){if(!e){e=e||{},window.permutive=e,e.q=[];var t=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})};e.config=i||{},e.config.apiKey=o,e.config.workspaceId=n,e.config.environment=e.config.environment||"production",(window.crypto||window.msCrypto)&&(e.config.viewId=t());for(var g=["addon","identify","track","trigger","query","segment","segments","ready","on","once","user","consent"],r=0;r<g.length;r++){var w=g[r];e[w]=function(o){return function(){var n=Array.prototype.slice.call(arguments,0);e.q.push({functionName:o,arguments:n})}}(w)}}}(window.permutive,"'.concat(e,'","').concat(n,'",{"consentRequired": true}); window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){if(0===window.googletag.pubads().getTargeting("permutive").length){var e=window.localStorage.getItem("_pdfps");window.googletag.pubads().setTargeting("permutive",e?JSON.parse(e):[]);var o=window.localStorage.getItem("permutive-id");o&&(window.googletag.pubads().setTargeting("puid",o),window.googletag.pubads().setTargeting("ptime",Date.now().toString())),window.permutive.config.viewId&&window.googletag.pubads().setTargeting("prmtvvid",window.permutive.config.viewId),window.permutive.config.workspaceId&&window.googletag.pubads().setTargeting("prmtvwid",window.permutive.config.workspaceId)}});\n                        permutive.addon(\'web\', {\n                            page: ').concat(JSON.stringify({...s,user:void 0}),'\n                        });\n						permutive.consent({ "opt_in": true, "token": "').concat(d,'" });\n						permutive.identify(').concat(JSON.stringify(h),');\n						performance.mark("Permutive consent opt_in true");\n\n						if (').concat(a&&!1,") {\n							__wmass.bff.push(function () {\n								__wmass.dmp.addon('web', {\n									page: ").concat(JSON.stringify({...s,user:void 0}),"\n								});\n							});\n						}\n						")}}),(0,r.jsx)(c(),{src:i}),(0,r.jsx)(c(),{id:"permutive-brand-metrics-script",dangerouslySetInnerHTML:{__html:"window._brandmetrics = window._brandmetrics || [];\n							window._brandmetrics.push({\n							  cmd: '_addeventlistener',\n							  val: {\n								event: 'surveyanswered',\n								handler: function (ev) {\n								  try {\n									if (window.permutive && window.permutive.track) {\n									  ev.answers.split(';').forEach(function (questionAnswers) {\n										questionAnswers = questionAnswers.split('-');\n										var question = questionAnswers[0] ? questionAnswers[0] : null;\n										var answer = null;\n\n										if (questionAnswers[1]) {\n										  const parsedAnswers = questionAnswers[1].split(',').map(answer => {\n											const trimmed = answer.trim();\n											return isNaN(trimmed) ? null : Number(trimmed);\n										  }).filter(value => value !== null && Number.isInteger(value));\n\n										  answer = parsedAnswers.length > 0 ? parsedAnswers[0] : null;\n										}\n\n										window.permutive.track('BrandMetricsSurveyResponse', {\n										  mid: ev.mid,\n										  question: question,\n										  answer: answer, // single integer or null\n										});\n									  });\n									}\n								  } catch (e) {\n									console.error('Error sending Brand Metrics data to Permutive', e);\n								  }\n								},\n							  },\n							});\n						"}})]})}return null},y=(0,o.A)(()=>!(0,w.useAmp)(),h,e=>{var t;let{pageProps:n}=e,i=g(n),a=null==n||null==(t=n.serverContext)?void 0:t.urlPath;return(0,r.jsx)(f,{urlPath:a,json:{...i,user:void 0}})})}}]);